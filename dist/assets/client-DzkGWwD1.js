const l=()=>(console.log("üìç Using VITE_API_URL:","https://tellyousomeday-backend-ACTUAL-URL.ondigitalocean.app/api"),"https://tellyousomeday-backend-ACTUAL-URL.ondigitalocean.app/api"),d=l();console.log("üîß Final API Configuration:",{API_BASE_URL:d,currentOrigin:window.location.origin,currentHostname:window.location.hostname,env:"production"});class u{constructor(e=d){this.baseURL=e}async request(e,s={}){const o=`${this.baseURL}${e}`;console.log("üåê API Request:",{url:o,method:s.method||"GET",baseURL:this.baseURL});const r={headers:{"Content-Type":"application/json",...s.headers},...s};r.body&&typeof r.body=="object"&&(r.body=JSON.stringify(r.body));try{const t=await fetch(o,r);console.log("üì° API Response:",{status:t.status,statusText:t.statusText,url:t.url,contentType:t.headers.get("content-type")});const i=t.headers.get("content-type");if(i&&i.includes("text/html"))throw console.error("üö® BACKEND NOT DEPLOYED: Received HTML instead of JSON"),new Error("Backend API not deployed. Please deploy the backend service first.");const a=await t.json();if(!t.ok)throw console.error("‚ùå API Error Response:",a),new Error(a.error||a.message||`HTTP error! status: ${t.status}`);return console.log("‚úÖ API Success:",a),a}catch(t){throw console.error("üí• API request failed:",{error:t.message,url:o,endpoint:e,baseURL:this.baseURL}),t.message.includes("Backend API not deployed")?new Error("Backend service is not deployed yet. Please deploy the backend first."):t.message.includes("fetch")?new Error("Cannot connect to backend API. Please check if the backend is running."):t}}async get(e,s={}){return this.request(e,{method:"GET",...s})}async post(e,s,o={}){return this.request(e,{method:"POST",body:s,...o})}async put(e,s,o={}){return this.request(e,{method:"PUT",body:s,...o})}async delete(e,s={}){return this.request(e,{method:"DELETE",...s})}}const c=new u,h={async createMessage(n){return c.post("/messages",n)},async searchMessages(n){return c.get(`/messages/search/${encodeURIComponent(n)}`)},async readMessage(n,e=null){return c.post(`/messages/read/${n}`,{password:e})},async getStats(){return c.get("/messages/stats")},async healthCheck(){return c.get("/health")}};export{c as default,h as messageAPI};
